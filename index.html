<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bing Chilling Media</title>
    <script>
    function setVh() {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    window.addEventListener('resize', setVh);
    window.addEventListener('load', setVh);
    setVh();
    </script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: calc(var(--vh, 1vh) * 100);
            background-color: #121212;
            margin: 0;
            font-family: 'Roboto', sans-serif;
            color: #ffffff;
        }
        .hidden {
            display: none;
        }
        .prompt-box {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            text-align: center;
            width: 90%;
            max-width: 400px;
        }
        input, textarea {
            width: calc(100% - 20px);
            margin-top: 10px;
            margin-bottom: 10px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #2e2e2e;
            color: #ffffff;
            box-sizing: border-box;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #6200ee;
            color: #ffffff;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3700b3;
        }
        img {
            max-width: 60%;
            border-radius: 10px;
            margin-bottom: 5px;
        }
    </style>
    <script>
        function createInitialPrompt() {
            const promptBox = document.createElement('div');
            promptBox.classList.add('prompt-box');
            promptBox.id = 'initial-prompt-box';
            
            const headingText = document.createElement('h1');
            headingText.textContent = 'Bing Chilling Media';
            headingText.style.fontSize = '30px';
            headingText.style.marginBottom = '20px';
            promptBox.appendChild(headingText);

            const promptText = document.createElement('p');
            promptText.textContent = 'Choose your movie or TV show.';
            promptBox.appendChild(promptText);

            const input = document.createElement('input');
            input.type = 'text';
            input.id = 'tmdb-query';
            input.addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    searchTMDB();
                }
            });
            promptBox.appendChild(input);

            const searchButton = document.createElement('button');
            searchButton.textContent = 'Search on TMDB';
            searchButton.onclick = searchTMDB;
            promptBox.appendChild(searchButton);

            document.body.appendChild(promptBox);

            document.addEventListener('keydown', function(event) {
                if (event.key === 'Enter' && document.getElementById('confirmation-prompt-box')) {
                    document.getElementById('ok-button').click();
                }
            });
        }

        async function searchTMDB() {
            var apiKey = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0OTNiNWI3ODhlM2U0NDM4Y2Y2ZmY0ODI3NTJjN2Q2MSIsIm5iZiI6MTcxOTMxMjU2OC41NTY3MDEsInN1YiI6IjY2N2E5ZTczOTdkMDQ3YWNlNTNiNWU2MiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.TRZDf_GmWas5rFhq-6wzT7RUJOCxvCUFf6hT-Jd9iIM';
            var query = document.getElementById('tmdb-query').value;
            if (query) {
                try {
                    let response = await fetch('https://api.themoviedb.org/3/search/multi?query=' + encodeURIComponent(query) + '&include_adult=false&language=en-US&page=1', {
                        method: 'GET',
                        headers: {
                            'Authorization': 'Bearer ' + apiKey,
                            'Accept': 'application/json'
                        }
                    });
                    let data = await response.json();
                    let result = data.results && data.results[0];
                    if (result) {
                        var id = result.id;
                        var name = result.title || result.name;
                        var year = (result.release_date || result.first_air_date || '').split('-')[0];
                        var posterPath = result.poster_path ? 'https://image.tmdb.org/t/p/w500' + result.poster_path : null;
                        var confirmationMessage =  name + ' (' + (year ? year : 'Unknown Year') + ')';
                        showConfirmationPrompt(confirmationMessage, id, posterPath);
                    } else {
                        alert('No results found.');
                    }
                } catch (error) {
                    alert('Error fetching data from TMDB: ' + error);
                }
            }
        }

        function showConfirmationPrompt(message, id, posterPath) {
            document.getElementById('initial-prompt-box').classList.add('hidden');

            const promptBox = document.createElement('div');
            promptBox.classList.add('prompt-box');
            promptBox.id = 'confirmation-prompt-box';
            
            const headingText = document.createElement('h2');
            headingText.textContent = 'You selected';
            headingText.style.fontSize = '30px';
            headingText.style.marginBottom = '10px';
            headingText.style.whiteSpace = 'pre-line';
            promptBox.appendChild(headingText);
            
            const footerText = document.createElement('p');
            footerText.textContent = 'TMDB ID: ' + id;
            footerText.style.marginBottom = '20px';
            promptBox.appendChild(footerText);

            if (posterPath) {
                const posterImage = document.createElement('img');
                posterImage.src = posterPath;
                promptBox.appendChild(posterImage);
            }

            const promptText = document.createElement('p');
            promptText.textContent = message;
            promptText.style.marginBottom = '20px';
            promptText.style.whiteSpace = 'pre-line';
            promptBox.appendChild(promptText);

            const confirmButton = document.createElement('button');
            confirmButton.textContent = 'OK';
            confirmButton.id = 'ok-button';
            confirmButton.onclick = function() {
                showCopyPrompt(id);
            };
            promptBox.appendChild(confirmButton);

            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.onclick = function() {
                promptBox.remove();
                document.getElementById('initial-prompt-box').classList.remove('hidden');
            };
            promptBox.appendChild(cancelButton);

            document.body.appendChild(promptBox);
        }

        function showCopyPrompt(id) {
            document.getElementById('confirmation-prompt-box').remove();

            const promptBox = document.createElement('div');
            promptBox.classList.add('prompt-box');
            promptBox.id = 'copy-prompt-box';

            const promptText = document.createElement('p');
            promptText.textContent = 'Copy the TMDB ID, then launch the video API.';
            promptBox.appendChild(promptText);

            const textArea = document.createElement('textarea');
            textArea.id = 'tmdb-id';
            textArea.value = id;
            textArea.readOnly = true;
            textArea.style.fontSize = '30px';
            promptBox.appendChild(textArea);

            const copyButton = document.createElement('button');
            copyButton.textContent = 'Copy to Clipboard';
            copyButton.onclick = function() {
                textArea.select();
                document.execCommand('copy');
            };
            promptBox.appendChild(copyButton);

            const launchButton = document.createElement('button');
            launchButton.textContent = 'Launch VidSrc API';
            launchButton.onclick = function() {
                window.location.href = 'https://vidsrc.pro/';
            };
            promptBox.appendChild(launchButton);

            document.body.appendChild(promptBox);
        }

        window.onload = createInitialPrompt;
    </script>
</head>
<body>
    <h1>Embedded Video</h1>
    <div class="video-container">
        <iframe src="https://vidsrc.pro/embed/movie/653346" allowfullscreen></iframe>
    </div>
</body>
</html>
